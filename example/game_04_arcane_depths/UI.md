# Arcane Depths 前端界面需求

> 目标：描述示例项目在前端展示时所需的界面模块、组件与数据映射，便于演示 `tables` 导出的 JSON/TS 在真实界面中的应用。

## 1. 技术基线
- 参考 `game_01_minirpg` 的 React + Tailwind 静态站结构。
- 数据来源：`serialize.js` 生成的 `json/js/ts` 产物与 `context.ts` 枚举。
- 推荐建立 `ui/` 目录，按页面拆分组件：`BaseCamp`, `SquadSetup`, `DungeonMap`, `BattleEncounter`, `EventDialog`, `EndScreen`。

## 2. 基地页面（BaseCamp）
- 模块：
  - **资源面板**：显示 `ResourceType` 数值合计。
  - **设施卡片**：遍历 `facilities`，展示等级、效果描述、升级按钮。
  - **任务/成就条目**：从 `tasks` 和 `achievements` 中筛选可领取项。
- 交互：
  - 升级按钮需读取 `unlockCost`，若资源不足则禁用。
  - 展示下一等级效果（数据存于 `facilities` 的 `nextLevel` 字段）。

## 2.5 Run 面板（Playable MVP）
- 模块组成：
  - **章节选择**：下拉选择 `chapters`，显示章节被动、起始资源与特色房型。
  - **英雄选择**：从 `heroes` 列表勾选 4 名队员，展示基础属性、特质、携带技能摘要。
  - **节点信息区**：读取 `map_templates` + `rooms`，显示当前节点类型、奖励、特殊规则。
  - **资源/遗物面板**：实时同步 Arcane/Crystal/Provision 与获得的遗物条目。
  - **英雄状态条**：显示剩余 HP、护盾（若有），战斗后动态刷新。
  - **运行日志**：滚动展示战斗回合、事件决策、商店交易、系统提示。
- 交互流程：
  1. 选择章节与英雄 → 点击「开始周目」。
  2. 根据当前节点类型显示「处理节点」按钮；事件/商店/休整节点弹出覆盖层供玩家选择。
  3. 战斗节点调用简化回合制模拟（英雄先手 → 敌方反击），日志记录每轮技能与伤害结算。
  4. 节点结算后自动推进到下一节点或下一层；全部完成后展示通关摘要，可重新开始。
  5. 随时保留「放弃周目」按钮，重置状态回到编队界面。

## 3. 队伍配置（SquadSetup）
- 模块：
  - **英雄列表**：按职业分组，显示基础属性、特质标签。
  - **技能面板**：引用 `skills` 与 `skill_links`，可拖拽至槽位。
  - **遗物仓库**：按稀有度过滤展示，显示携带限制。
- 交互：
  - 拖拽装备/技能至英雄卡牌，引发即时数据验证（根据 Schema 提供类型保障）。
  - 组合面板显示团队综合评分与警告（能量不足、缺治疗等）。

## 4. 地图视图（DungeonMap）
- 模块：
  - **层级导航**：显示当前层、剩余路径，支持回顾已走路径。
  - **节点图**：从 `map_templates` 读取节点，按 `edgeLeft/edgeRight` 绘制连线。
  - **房间摘要弹窗**：展示 `rooms` 中的奖励、敌人类型、事件提示。
- 交互：
  - 点击可达节点触发 `Encounter` 入口。
  - 节点状态：未访问、已完成、锁定、特殊（精英/Boss）。

## 5. 战斗界面（BattleEncounter）
- 布局分区：
  - **角色面板**：显示头像、HP、护盾、状态图标（来源于 `statusEffects` 列）。
  - **技能面板**：按英雄显示技能卡牌，使用 `cost`, `cooldown`, `tags`。
  - **行动顺序条**：基于敌我 `speed` 计算下一行动者。
  - **战报窗**：实时记录来自 `BattleLog` 的事件，日志结构可由模拟器生成。
- 交互：
  - 技能选择支持查看详细效果（引用 `effects` 描述）。
  - 遗物触发以徽章形式在界面右上角闪烁。

## 6. 事件弹窗（EventDialog）
- 模块：
  - **事件插画与描述**（`textId` 映射外部文案）。
  - **选项列表**：每个选项显示需求、成功率、奖励/惩罚。
  - **结果反馈**：动画 + 文本展示。
- 交互：
  - 根据 `requirement` 判断是否可选，如 `type = SkillTag` 则需要队伍中存在对应标签。
  - 某些选项可触发后续事件 ID，界面应在结尾提供“继续探索”按钮。
  - MVP 中在 Run 面板内以覆盖层呈现，确认后写入日志并推进节点。

## 7. 商人 / 休整界面（Intermission）
- 商店组件：
  - 商品卡片包含图标、名称、描述、价格、库存。
  - 按 `Provision` 资源扣费，库存为 0 时置灰。
- 休整组件：
  - 表单式 UI，提供恢复血量、移除状态、强化技能等操作。
  - 需要展示每项服务的成本和收益（来自 `rooms.recoveryOptions` 字段）。
 - MVP 中提供两种操作（购买/略过，治疗/增益），选择后立即更新资源与英雄生命值，写入日志。

## 8. 结算界面（EndScreen）
- 模块：
  - **表现摘要**：战斗胜败、总伤害、受到伤害、耗时。
  - **奖励列表**：资源与遗物；永久解锁内容以“新！”标签高亮。
  - **历史记录按钮**：跳转查看过往周目统计。
- 交互：
  - 若未通关，提示保留资源比例。
  - 如果解锁新的研究节点，提供快捷进入基地研究界面的按钮。

## 9. 共通需求
- 支持 `jsonx` 协议数据：在加载时校验 `protocol` 字段，提示版本不匹配。
- 所有界面应以 Schema 生成的 TS 类型作为 props，减少手写类型。
- 需保留调试面板，显示当前周目状态（章节、层数、遗物、任务进度）。

此 UI 需求文档为后续前端原型和数据绑定提供依据，并指引需要在 Excel 中准备的字段。
